# KiBot preflight for setting Text Variables
# https://kibot.readthedocs.io/en/latest/configuration/preflights/set_text_variables.html

kibot:
  version: 1

preflight:
  update_xml: true
  set_text_variables:

    # Git related information
    - variable: 'REVISION'
      # command: 'git describe --tags --abbrev=0 || echo ""'
      text: '@REVISION@'
    - variable: 'RELEASE_DATE'
      command: 'git log -1 --format="%ad" --date="format:%d-%b-%Y"'
    - variable: 'RELEASE_DATE_NUM'
      command: 'git log -1 --format="%ad" --date=short'
    - variable: 'GIT_HASH_SCH'
      command: 'git log -1 --format="%h" $KIBOT_SCH_NAME'
    - variable: 'GIT_HASH_PCB'
      command: 'git log -1 --format="%h" $KIBOT_PCB_NAME'

    # Metadata
    - variable: 'PROJECT_NAME'
      text: '@PROJECT_NAME@'
    - variable: 'BOARD_NAME'
      text: '@BOARD_NAME@'
    - variable: 'COMPANY'
      text: '@COMPANY@'
    - variable: 'DESIGNER'
      text: '@DESIGNER@'
    - variable: 'VARIANT'
      text: '%V'

    # Page titles for automatic ToC
    - variable: 'SHEET_NAME_1'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 1 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_2'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 2 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_3'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 3 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_4'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 4 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_5'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 5 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_6'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 6 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_7'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 7 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_8'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 8 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_9'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 9 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_10'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 10 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_11'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 11 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_12'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 12 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_13'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 13 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_14'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 14 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_15'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 15 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_16'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 16 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_17'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 17 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_18'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 18 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_19'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 19 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_20'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 20 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_21'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 21 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_22'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 22 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_23'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 23 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_24'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 24 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_25'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 25 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_26'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 26 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_27'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 27 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_28'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 28 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_29'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 29 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_30'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 30 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_31'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 31 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_32'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 32 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_33'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 33 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_34'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 34 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_35'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 35 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_36'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 36 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_37'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 37 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_38'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 38 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_39'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 39 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'
    - variable: 'SHEET_NAME_40'
      command: 'python3 kibot_yaml/get_sheet_title.py -p 40 -f "${KIBOT_SCH_NAME%.kicad_sch}.xml"'

...
definitions:
  PROJECT_NAME: ""
  BOARD_NAME: ""
  COMPANY: ""
  DESIGNER: ""
  REVISION: ""
  RELEASE_DATE: ""
  RELEASE_DATE_NUM: ""